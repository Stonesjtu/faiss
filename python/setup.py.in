"""This is a template python script where ${VARIABLE} will be replaced
at `CMAKE` phase"""
import shutil
from distutils.core import setup


PACKAGE_NAME = '${PROJECT_NAME}'
VERSION = '${PROJECT_VERSION}'
# files generated by SWIG, .py and .so
SWIG_FILES = '${PYTHON_INSTALL_FILES}'.split(';')
# source directory for hand written SWIG wrapper
MANUAL_DIR = '${CMAKE_CURRENT_SOURCE_DIR}/faiss'
# target package directory to install into python lib
TARGET_DIRECTORY = '${CMAKE_CURRENT_BINARY_DIR}/faiss'

# copy the manual files from python to build/python
shutil.rmtree(TARGET_DIRECTORY, ignore_errors=True)
shutil.copytree(MANUAL_DIR, TARGET_DIRECTORY)

# copy the manual wrapper to build target
for filename in SWIG_FILES:
    shutil.copy(filename, TARGET_DIRECTORY)


long_description="""
Faiss is a library for efficient similarity search and clustering of dense
vectors. It contains algorithms that search in sets of vectors of any size,
 up to ones that possibly do not fit in RAM. It also contains supporting
code for evaluation and parameter tuning. Faiss is written in C++ with
complete wrappers for Python/numpy. Some of the most useful algorithms
are implemented on the GPU. It is developed by Facebook AI Research.
"""
setup(
    name=PACKAGE_NAME,
    version=VERSION,
    description='A library for efficient similarity search and clustering of dense vectors',
    long_description=long_description,
    url='https://github.com/facebookresearch/faiss',
    author='Matthijs Douze, Jeff Johnson, Herve Jegou',
    author_email='matthijs@fb.com',
    license='BSD',
    keywords='search nearest neighbors',

    install_requires=['numpy'],
    packages=[PACKAGE_NAME],
    package_data={
        PACKAGE_NAME: ['*.so'],
    }
)
