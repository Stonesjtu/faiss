"""This is a template python script where ${VARIABLE} will be replaced
at `CMAKE` phase"""
import shutil
from distutils.core import setup


PACKAGE_NAME = '${PROJECT_NAME}'
VERSION= '${PROJECT_VERSION}'
# files generated by SWIG, .py and .so
SWIG_FILES = '${PYTHON_INSTALL_FILES}'.split(';')
# source directory for hand written SWIG wrapper
MANUAL_DIR = '${CMAKE_CURRENT_SOURCE_DIR}/faiss'
# target package directory to install into python lib
TARGET_DIRECTORY = '${CMAKE_CURRENT_BINARY_DIR}/faiss'

# copy the manual files from python to build/python
shutil.rmtree(TARGET_DIRECTORY, ignore_errors=True)
shutil.copytree(MANUAL_DIR, TARGET_DIRECTORY)

# copy the manual wrapper to build target
for filename in SWIG_FILES:
    shutil.copy(filename, TARGET_DIRECTORY)


setup(
    name=PACKAGE_NAME,
    version=VERSION,
    # package_dir={'': TARGET_DIRECTORY},
    packages=[PACKAGE_NAME],
    package_data={
        PACKAGE_NAME: ['*.so'],
    }
)
